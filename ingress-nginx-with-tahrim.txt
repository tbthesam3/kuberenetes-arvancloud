helm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx
helm repo list
helm repo update

docker pull registry.k8s.io/ingress-nginx/controller:v1.14.3
docker tag registry.k8s.io/ingress-nginx/controller:v1.14.3 registry.k8s.io/ingress-nginx/controller:v1.14.3
kind load docker-image registry.k8s.io/ingress-nginx/controller:v1.14.3 --name kind-lab

helm.values.yaml:

controller:
  replicaCount: 2
  minAvailable: 1

  image:
    repository: registry.k8s.io/ingress-nginx/controller
    tag: v1.14.3       # نسخه‌ای که preload شده
    digest: ""         # digest خالی تا از pull اینترنتی جلوگیری شود

  service:
    externalTrafficPolicy: Local
    nodePorts:
      http: 32080
      https: 32443
    type: NodePort

  ingressClassResource:
    name: nginx
    enabled: true
    default: true

  resources:
    limits:
      cpu: 500m
      memory: 1024Mi
    requests:
      cpu: 100m
      memory: 90Mi

  metrics:
    port: 10254
    enabled: true
    service:
      type: NodePort
      nodePort: "32254"

  admissionWebhooks:
    enabled: true
    patch:
      image:
        repository: registry.k8s.io/ingress-nginx/kube-webhook-certgen
        tag: v1.6.6       # نسخه‌ای که preload شده
        digest: ""        # digest خالی تا از pull اینترنتی جلوگیری شود



helm upgrade --install ingress-nginx ingress-nginx/ingress-nginx \
  --namespace ingress-nginx \
  --create-namespace \
  -f /root/helm.values.yaml
